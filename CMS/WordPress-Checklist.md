# WordPress Checklist

### WordPress Core Version Detection

WordPress core version can be detected from generator tag and via CSS or JS file in the source code of the page.

**Example:**
```
<meta name="generator" content="WordPress 5.4.2" />
```
```
style.min.css?ver=5.4.2
```

### Themes Detection & Enumeration

Themes can be detected from via CSS or JS file in the source code of the page.

**Example:**
```
example.com/wp-content/themes/HERE/style.css?ver=5.4.2
```

Theme information (such as version) can be detected via readme.txt file.

**Example:**
```
example.com/wp-content/themes/HERE/readme.txt
```

It can be detected by performing brute force attack for installed but unused themes.

**Example:**
```
example.com/wp-content/themes/HERE # If the theme is used, the returning HTTP response will be different.
```

Information gathering about themes can be collected with WPScan tool.

```
wpscan --url https://example.com --enumerate vt
```

### Plugins Detection & Enumeration

Plugins can be detected from via CSS or JS file in the source code of the page.

**Example:**
```
example.com/wp-content/plugins/HERE/
```
However, some plugins information is not exposed in the source code, so brute force attack must be done to find all installed plugins.

**Example:**
```
example.com/wp-content/plugins/HERE # If the plugin is used, the returning HTTP response will be different.
```
Plugin information (such as version) can be detected via readme.txt file.

**Example:**
```
example.com/wp-content/plugins/HERE/readme.txt
```
Information gathering about plugins can be collected with WPScan tool

```
wpscan --url https://example.com --enumerate vp
```

### Users Detection

Brute force attack on author parameter.

**Example:**
```
example.com/?author=HERE # If there is user, the returning HTTP response will be different.
```

WP-JSON REST API

**Example:**
```
example.com/wp-json/wp/v2/users
```

Brute force attack on login panel. If there is user, the returning HTTP response will be different.

### Brute force attack on Login Panel

After wordpress installation, login is by default wp-login.php. With hardening these default paths can be changed. If there is such a case, firstly directory fuzzing should be made and login panel should be determined.

**Hydra:**
```
hydra -L username.txt -P password.txt www.example.com -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location'
```
**WPScan:**
```
wpscan â€“url https://www.example.com --wordlist wordlist.txt --username admin
```

### Other Controls

Is directory listing active?

**Example:**
```
https://www.example.com/wp-includes
https://www.example.com/wp-content/uploads
```

Can you access XMLRPC?

**Example:**
```
https://www.example.com/xmlrpc.php
```

**Brute force attack via XMLRPC**
```
curl -X POST -d "<methodCall><methodName>wp.getUsersBlogs</methodName><params><param><value>admin</value></param><param><value>pass</value></param></params></methodCall>" https://www.example.com/xmlrpc.php
```

Scanning all ports of the server. For example: Is the database port open to the external?

Control of sensitive files and directory (Directory fuzzing) For example: robots.txt, .htaccess, phpmyadmin, backup/log files

Captcha control in areas such as contact form and login form

Checking HTTP responses returned from the application. For example, is there version information disclosure?

Checking SSL/TLS

Checking HTTP security header and cookie flags

### Useful Links:
* [WPScan Vulnerability Database](https://wpvulndb.com/)

